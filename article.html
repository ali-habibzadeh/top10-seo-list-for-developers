<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Top 10 things Developer need to know about SEO</title>
    <link
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <div class="container">
      <div class="py-5 text-center">
        <img
          class="d-block mx-auto mb-4"
          src="https://www.deepcrawl.com/wp-content/themes/deepcrawl/images/deepcrawl-logo.svg"
          alt="drawing"
          width="200"
        />
        <h1>Top 10 things Developer need to know about SEO</h1>
        <p class="lead">
          A Simple API containing a curated set of metrics about the health of a webpage from the technical SEO point of
          view. It should act as a starting point for an engineer who likes to play and learn more about extracting
          insights from web pages for the purposes of SEO or testing.
        </p>
      </div>

      <h2>Express Server and Router</h2>

      <p>Set up an Express server and set it to use our apiRouter on <code>/api</code> path and listen on a port</p>

      <script src="https://gist-it.appspot.com/https://github.com/deepcrawl/top10-seo-list-for-developers/blob/master/src/index.ts"></script>

      <p>
        Create an instance of Express Router and add a <code>get</code> route matcher on path
        <code>/page-leath</code> to use our main handler function. This now makes your API route to be
        <code>/api/page-health</code>.
      </p>

      <script src="https://gist-it.appspot.com/https://github.com/deepcrawl/top10-seo-list-for-developers/blob/master/src/api/routes.ts"></script>

      <p>
        Now let's create our handler function. It needs to be able to read the query string parameter for
        <code>?url=</code> and validate it. If it checks out we can pass it to our render service to process it.
        Otherwise we send an error response to the user to correct the faulty parameter.
      </p>

      <script src="https://gist-it.appspot.com/https://github.com/deepcrawl/top10-seo-list-for-developers/blob/master/src/api/page-health.route.ts"></script>

      <p>
        Here is how we validate the URL. URL class throws an error when the passed string can not be constrcted into a
        URL instance. So it's an easy to to validate a string.
      </p>

      <script src="https://gist-it.appspot.com/https://github.com/deepcrawl/top10-seo-list-for-developers/blob/master/src/utils/url.utils.ts"></script>

      <p>Ok now we are done with our general scaffolding for the API side. Let's build some software!</p>

      <h2>Rendering Pages</h2>

      <p>Our core service for the app is our render service. with few simple duties:</p>

      <ul>
        <li>Take the URL passed to it from API router</li>
        <li>Create a puppeteer browser</li>
        <li>Create a page and response object and pass it to all our metrics</li>
        <li>Return the results from all metrics</li>
        <li>Close browser</li>
      </ul>

    <script
        src="https://gist-it.appspot.com/https://github.com/deepcrawl/top10-seo-list-for-developers/blob/master/src/page-rendering/page-render.service.ts"></script>

      <p>But as always the devil is in the details and there are few gotchas invovled:</p>

      <ol>
        <li>
            <h4>Chrome switches</h4>
          <p>
            We don't want to run many APIs chrome comes with out of the box, they are to slow down our service. For this
            we will use a custom <code>launchOptions</code> for puppeteer's <code>launch</code> function, so we can pass in a set a chrome swtiches</a>
            that would disable most of what we won't need.            
          </p>
            <script
                src="https://gist-it.appspot.com/https://github.com/deepcrawl/top10-seo-list-for-developers/blob/master/src/page-rendering/config/constants/launch-options.ts"></script>

                <p>We won't go into much details but you can checkout the list of 
                    <a href="https://github.com/deepcrawl/top10-seo-list-for-developers/blob/master/src/page-rendering/config/constants/chrome-switches.ts" target="_blank">switches passed into chrome</a> 
                    for disabling various features and Web APIs. You can also see the <a href="https://peter.sh/experiments/chromium-command-line-switches/" target="_blank">full list of args that chrome takes</a>.</p>
        </li>
        <li>
            <h4>Rejection tokens</h4>
         <p>
            We don't want to request any possible large assets of the page. Specially if they don't help us in calculation
            of our metrics. so we need to abort the requests that are made to <a href="https://github.com/deepcrawl/top10-seo-list-for-developers/blob/master/src/page-rendering/config/constants/blocked-resource-types.ts" target="_blank">such resources</a>.
         </p>

         <p>We also don't want our test to run any Analytics events so we would need to create a list of <a href="https://github.com/deepcrawl/top10-seo-list-for-developers/blob/master/src/page-rendering/config/constants/analytics-rejections.ts" target="_blank">typical analytics servers</a> too.</p>

         <p>And finally we need to also block any reqeust made to well known <a href="https://github.com/deepcrawl/top10-seo-list-for-developers/blob/master/src/page-rendering/config/constants/ad-rejections.ts" target="_blank">Advertising servers</a>, as they just slow down the whoe process.</p>

         <p>Now we are able to easily check whether the request URL is ResourceType is maching any of these types. And if so we can <code>.abort</code> the request and otherwise we simply <code>.continue</code></p>
        <script
            src="https://gist-it.appspot.com/https://github.com/deepcrawl/top10-seo-list-for-developers/blob/master/src/page-rendering/config/page-request.handler.ts"></script>
        </li>
      </ol>

      <p>This consititues all the lifting that needs to be done before we can finally add some metrics to our API.</p>

      <h2>The metrics</h2>

      <p>We want all our metrics to have the same blue print as we simply want to pass them all as an array into our rednering service and get a consistent set of results from them. To do so we need to create a blue print abstract class which they all will extend.</p>

      <p>The base metric will set few standards for our metrics:</p>

      <ul>
          <li>All metrics will get their results from puppeteer's <code>Page</code> and <code>Response</code></li>
          <li>We need the response payloads to provide information about the type of data returned from each metric. We do this for better usability of our data, so another program can easily read what type the data has so it can pick the right type of handling logic against that metric.</li>
          <li>We also want all metrics to have a unique name so that they can be easily picked from the list if needed.</li>
      </ul>
    <script
        src="https://gist-it.appspot.com/https://github.com/deepcrawl/top10-seo-list-for-developers/blob/master/src/metrics/base-types/base-metric.ts"></script>


    <h3>
        Metric items
    </h3>

    <ol>
        <li>

            <h5>Internal links</h4>

            <p>The easiest way of determining if a list is internal is to check for that link is not external. and we simply do this by checking if the href's hostname is different to the current page's href hostname. see <code>isExternalLink</code> method below.</p>

            <script
                src="https://gist-it.appspot.com/https://github.com/deepcrawl/top10-seo-list-for-developers/blob/master/src/metrics/metric-items/internal-links/internal-links.ts"></script>

        </li>
    </ol>
   
    </div>
  </body>
</html>
